<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Linear Regression | Analysing Quantitative Data with R</title>
  <meta name="description" content="9 Linear Regression | Analysing Quantitative Data with R" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Linear Regression | Analysing Quantitative Data with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Linear Regression | Analysing Quantitative Data with R" />
  
  
  

<meta name="author" content="Florian Reiche &amp; Piotr Bogdanski" />
<meta name="author" content="Department of Politics and International Studies, University of Warwick" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="association.html"/>
<link rel="next" href="logit.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/font-awesome-5.13.0/js/script.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I THE BASICS</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#content"><i class="fa fa-check"></i><b>1.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#what-is-r-and-why-should-i-learn-it"><i class="fa fa-check"></i>What is R and why should I learn it?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#the-course-structure"><i class="fa fa-check"></i>The course structure</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#setup"><i class="fa fa-check"></i>Setup</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#layout"><i class="fa fa-check"></i>Layout</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basics of R Programming</a><ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#content-1"><i class="fa fa-check"></i><b>2.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#arithmetic-operations-and-assignment"><i class="fa fa-check"></i>Arithmetic operations and assignment</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#coercion"><i class="fa fa-check"></i>Coercion</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#logical-values-and-operators"><i class="fa fa-check"></i>Logical Values and Operators</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#indexing"><i class="fa fa-check"></i>Indexing</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#sorting"><i class="fa fa-check"></i>Sorting</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basics.html"><a href="basics.html#summary"><i class="fa fa-check"></i><b>2.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#functions-list"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basics.html"><a href="basics.html#exercises"><i class="fa fa-check"></i><b>2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datastructures.html"><a href="datastructures.html"><i class="fa fa-check"></i><b>3</b> Data structures</a><ul>
<li class="chapter" data-level="3.1" data-path="datastructures.html"><a href="datastructures.html#content-2"><i class="fa fa-check"></i><b>3.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="datastructures.html"><a href="datastructures.html#data-frames"><i class="fa fa-check"></i>Data Frames</a></li>
<li class="chapter" data-level="" data-path="datastructures.html"><a href="datastructures.html#factors"><i class="fa fa-check"></i>Factors</a></li>
<li class="chapter" data-level="" data-path="datastructures.html"><a href="datastructures.html#reading-and-writing-the-data"><i class="fa fa-check"></i>Reading and writing the data</a></li>
<li class="chapter" data-level="" data-path="datastructures.html"><a href="datastructures.html#missing-values"><i class="fa fa-check"></i>Missing values</a></li>
<li class="chapter" data-level="" data-path="datastructures.html"><a href="datastructures.html#lists"><i class="fa fa-check"></i>Lists</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datastructures.html"><a href="datastructures.html#summary-1"><i class="fa fa-check"></i><b>3.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="datastructures.html"><a href="datastructures.html#functions-list-1"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datastructures.html"><a href="datastructures.html#exercises-1"><i class="fa fa-check"></i><b>3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory.html"><a href="exploratory.html"><i class="fa fa-check"></i><b>4</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="exploratory.html"><a href="exploratory.html#content-3"><i class="fa fa-check"></i><b>4.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="exploratory.html"><a href="exploratory.html#what-is-exploratory-data-analysis"><i class="fa fa-check"></i>What is exploratory data analysis?</a></li>
<li class="chapter" data-level="" data-path="exploratory.html"><a href="exploratory.html#first-look-at-the-data"><i class="fa fa-check"></i>First look at the data</a></li>
<li class="chapter" data-level="" data-path="exploratory.html"><a href="exploratory.html#numeric-vs-categorical-variables"><i class="fa fa-check"></i>Numeric vs categorical variables</a></li>
<li class="chapter" data-level="" data-path="exploratory.html"><a href="exploratory.html#numeric-variables"><i class="fa fa-check"></i>Numeric variables</a></li>
<li class="chapter" data-level="" data-path="exploratory.html"><a href="exploratory.html#categorical-variables"><i class="fa fa-check"></i>Categorical variables</a></li>
<li class="chapter" data-level="" data-path="exploratory.html"><a href="exploratory.html#customizing-visualizations"><i class="fa fa-check"></i>Customizing visualizations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="exploratory.html"><a href="exploratory.html#summary-2"><i class="fa fa-check"></i><b>4.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="exploratory.html"><a href="exploratory.html#functions-list-2"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="exploratory.html"><a href="exploratory.html#exercises-2"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II ADVANCED DATA MANIPULATION</b></span></li>
<li class="chapter" data-level="5" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>5</b> Key Programming Concepts</a><ul>
<li class="chapter" data-level="5.1" data-path="programming.html"><a href="programming.html#content-4"><i class="fa fa-check"></i><b>5.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#control-flow-statements"><i class="fa fa-check"></i>Control flow statements</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#for-loops"><i class="fa fa-check"></i>For loops</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#if-statements"><i class="fa fa-check"></i>If statements</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#sapply"><i class="fa fa-check"></i>Sapply</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="programming.html"><a href="programming.html#summary-3"><i class="fa fa-check"></i><b>5.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#functions-list-3"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="programming.html"><a href="programming.html#exercises-3"><i class="fa fa-check"></i><b>5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Data Manipulation</a><ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#content-5"><i class="fa fa-check"></i><b>6.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#reading-the-data"><i class="fa fa-check"></i>Reading the data</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#the-pipe-operator"><i class="fa fa-check"></i>The pipe operator</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#dataset-manipulation"><i class="fa fa-check"></i>Dataset manipulation</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#reshaping-data"><i class="fa fa-check"></i>Reshaping data</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#joining"><i class="fa fa-check"></i>Joining</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#aggregating-data"><i class="fa fa-check"></i>Aggregating data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#summary-4"><i class="fa fa-check"></i><b>6.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#functions-list-4"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#exercises-4"><i class="fa fa-check"></i><b>6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>7</b> Data Visualization</a><ul>
<li class="chapter" data-level="7.1" data-path="visualization.html"><a href="visualization.html#content-6"><i class="fa fa-check"></i><b>7.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#the-plotting-syntax"><i class="fa fa-check"></i>The plotting syntax</a></li>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#all-about-geoms---plot-types-in-ggplot2"><i class="fa fa-check"></i>All about geoms - plot types in ggplot2</a></li>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#multiple-plots"><i class="fa fa-check"></i>Multiple plots</a></li>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#customizing-plots"><i class="fa fa-check"></i>Customizing plots</a></li>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#saving-plots"><i class="fa fa-check"></i>Saving plots</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="visualization.html"><a href="visualization.html#summary-5"><i class="fa fa-check"></i><b>7.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html#functions-list-5"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="visualization.html"><a href="visualization.html#exercises-5"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III DATA ANALYSIS</b></span></li>
<li class="chapter" data-level="8" data-path="association.html"><a href="association.html"><i class="fa fa-check"></i><b>8</b> Statistical Inference and Association</a><ul>
<li class="chapter" data-level="8.1" data-path="association.html"><a href="association.html#content-7"><i class="fa fa-check"></i><b>8.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="association.html"><a href="association.html#comparing-means"><i class="fa fa-check"></i>Comparing means</a></li>
<li class="chapter" data-level="" data-path="association.html"><a href="association.html#relationship-between-two-continuous-variables"><i class="fa fa-check"></i>Relationship between two continuous variables</a></li>
<li class="chapter" data-level="" data-path="association.html"><a href="association.html#further-details"><i class="fa fa-check"></i>Further details</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="association.html"><a href="association.html#summary-6"><i class="fa fa-check"></i><b>8.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="association.html"><a href="association.html#functions-list-6"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="association.html"><a href="association.html#exercises-6"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ols.html"><a href="ols.html"><i class="fa fa-check"></i><b>9</b> Linear Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="ols.html"><a href="ols.html#content-8"><i class="fa fa-check"></i><b>9.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="ols.html"><a href="ols.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="ols.html"><a href="ols.html#bivariate-linear-regression"><i class="fa fa-check"></i>Bivariate Linear Regression</a></li>
<li class="chapter" data-level="" data-path="ols.html"><a href="ols.html#multiple-linear-regression"><i class="fa fa-check"></i>Multiple Linear Regression</a></li>
<li class="chapter" data-level="" data-path="ols.html"><a href="ols.html#the-classical-linear-assumptions"><i class="fa fa-check"></i>The Classical Linear Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ols.html"><a href="ols.html#summary-7"><i class="fa fa-check"></i><b>9.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="ols.html"><a href="ols.html#functions-list-7"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ols.html"><a href="ols.html#exercises-7"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
<li class="chapter" data-level="9.4" data-path="ols.html"><a href="ols.html#references"><i class="fa fa-check"></i><b>9.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="logit.html"><a href="logit.html"><i class="fa fa-check"></i><b>10</b> Logistic Regression</a><ul>
<li class="chapter" data-level="10.1" data-path="logit.html"><a href="logit.html#content-9"><i class="fa fa-check"></i><b>10.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#logit---the-intuition"><i class="fa fa-check"></i>Logit - The Intuition</a></li>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#logit---the-estimation"><i class="fa fa-check"></i>Logit - The Estimation</a></li>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#logit---the-output"><i class="fa fa-check"></i>Logit - The Output</a></li>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#logit---model-fit"><i class="fa fa-check"></i>Logit - Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="logit.html"><a href="logit.html#summary-8"><i class="fa fa-check"></i><b>10.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="logit.html"><a href="logit.html#functions-list-8"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="logit.html"><a href="logit.html#exercises-8"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>IV ADVANCED TOPICS</b></span></li>
<li class="chapter" data-level="11" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>11</b> R Markdown</a><ul>
<li class="chapter" data-level="11.1" data-path="rmarkdown.html"><a href="rmarkdown.html#content-10"><i class="fa fa-check"></i><b>11.1</b> Content</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#introduction-2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#usage"><i class="fa fa-check"></i>Usage</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#the-components-of-an-r-markdown-document"><i class="fa fa-check"></i>The Components of an R Markdown Document</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#figures-and-graphs"><i class="fa fa-check"></i>Figures and Graphs</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#useful-stuff"><i class="fa fa-check"></i>Useful Stuff</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#bibliography"><i class="fa fa-check"></i>Bibliography</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="rmarkdown.html"><a href="rmarkdown.html#summary-9"><i class="fa fa-check"></i><b>11.2</b> Summary</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#functions-list-9"><i class="fa fa-check"></i>Functions list</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="rmarkdown.html"><a href="rmarkdown.html#exercises-9"><i class="fa fa-check"></i><b>11.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="course-summary.html"><a href="course-summary.html"><i class="fa fa-check"></i><b>12</b> Course summary</a><ul>
<li class="chapter" data-level="" data-path="course-summary.html"><a href="course-summary.html#index-of-functions-used-throughout-the-course"><i class="fa fa-check"></i>Index of functions used throughout the course</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysing Quantitative Data with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ols" class="section level1">
<h1><span class="header-section-number">9</span> Linear Regression</h1>
<p><a href="data:text/plain;base64,IycgIyBMaW5lYXIgUmVncmVzc2lvbiAKCiMnIAojJyAKIycgCiMnIAojJyAjIyBDb250ZW50CiMnIAojJyA8Y2VudGVyPiBfX1NpdGUgc3RpbGwgdW5kZXIgY29uc3RydWN0aW9uIV9fIDwvY2VudGVyPgojJyAKIycgIyMjIEludHJvZHVjdGlvbiAKCiMnIAojJyAKIycgRGF0YSBhcmUgdGFrZW4gZnJvbSBodHRwczovL2VsZWN0aW9uc3R1ZGllcy5vcmcvZGF0YS1jZW50ZXIvMjAyMC1leHBsb3JhdG9yeS10ZXN0aW5nLXN1cnZleS8gdG8gbW9kZWwgdGhlIGZlZWxpbmdzIHRvd2FyZHMgRG9uYWxkIFRydW1wIGluIHRoZSBsZWFkLXVwIHRvIHRoZSBwcmVzaWRlbnRpYWwgZWxlY3Rpb24gMjAyMC4KIycgCiMnIAojJyAKIycgIyMjIEJpdmFyaWF0ZSBMaW5lYXIgUmVncmVzc2lvbiAKCiMnIAojJyAjIyMjIFRoZSBUaGVvcnkgCgojJyAKIycgIyMjIyBUaGUgQXBwbGljYXRpb24gCgojJyAKIycgV2UgYXJlIHVzaW5nIHRoZSAiMjAyMCBFeHBsb3JhdG9yeSBUZXN0aW5nIFN1cnZleSIKIycgCiMnIExvYWQgdGhlIEFORVMgZGF0YSBzZXQKIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFuZXMgPC0gcmVhZC5jc3YoImRhdGEvYW5lcy5jc3YiKQoKIycgCiMnIAojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdW1tYXJ5KGFuZXMkZnR0cnVtcDEpCgojJyAKIycgVGhpcyBpcyBubyBnb29kLCBhcyB0aGUgdmFyaWFibGUgaXMgYm91bmRlZCBiZXR3ZWVuIDAgYW5kIDEwMC4gSW4gZmFjdCA5OTkgaXMgYSBwbGFjZWhvbGRlciBmb3IgbWlzc2luZyBkYXRhIHRocm91Z2hvdXQgdGhlIGRhdGEgc2V0LiBXZSBuZWVkIHRvIHJlcGxhY2UgdGhpcyB3aXRoIE5Bcy4KIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFuZXNbYW5lcyA9PSA5OTldIDwtIE5BCgojJyAKIycgSWYgd2UgbG9vayBhdCB0aGUgc3VtbWFyeSBhZ2FpbiwgZXZlcnl0aGluZyBsb29rcyBmaW5lIG5vdzoKIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1bW1hcnkoYW5lcyRmdHRydW1wMSkKCiMnIAojJyBCeSB0aGUgd2F5LCBoYWQgeW91IGp1c3Qgd2FudGVkIHRvIHJlcGxhY2UgdGhpcyBpbiBvbmUgdmFyaWFibGUsIGZvciBleGFtcGxlIG9ubHkgaW4gYGZ0dHJ1bXAxYCwgeW91IGNvdWxkIGhhdmUgY2FsbGVkOgojJyAKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyMgYW5lcyRmdHRydW1wMSA8LSB3aXRoKGFuZXMsIHJlcGxhY2UoZnR0cnVtcDEsIGZ0dHJ1bXAxID09IDk5OSwgTkEpKQoKIycgCiMnIE5vcnJpcyBhbmQgSW5nbGVoYXJ0ICgyMDE2KSBoYXZlIGFyZ3VlZCB0aGF0OgojJyAKIycgPnBvcHVsaXN0IHN1cHBvcnQgaW4gRXVyb3BlIGlzIGdlbmVyYWxseSBzdHJvbmdlciBhbW9uZyB0aGUgb2xkZXIgZ2VuZXJhdGlvbiwgbWVuLCB0aGUgbGVzcyBlZHVjYXRlZCwgdGhlIHJlbGlnaW91cywgYW5kIGV0aG5pYyBtYWpvcml0aWVzLCBwYXR0ZXJucyBjb25maXJtaW5nIHByZXZpb3VzIHJlc2VhcmNoLgojJyAKIycgTGV0J3Mgc2VlIGlmIHRoaXMgYWxzbyBhcHBsaWVzIHRvIHByZXNpZGVudGlhbCBlbGVjdGlvbnMgaW4gdGhlIFVTLiBXZSBmaXJzdCBsb29rIGF0IHRoZSBxdWVzdGlvbjogIkRvIG9sZGVyIHBlb3BsZSByYXRlIFRydW1wIGhpZ2hlciB0aGFuIHlvdW5nZXIgcGVvcGxlPyIuIE91ciBpbmRlcGVuZGVudCB2YXJpYWJsZXMgaXMgYGFnZWAuCiMnIAojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdW1tYXJ5KGFuZXMkYWdlKQoKIycgCiMnIExldCdzIGV2YWx1YXRlIHRoZSByZWxhdGlvbnNoaXAgdGhyb3VnaCBhIHNjYXR0ZXIgcGxvdCB3aXRoIGEgbGluZSBvZiBiZXN0IGZpdDoKIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmxpYnJhcnkodGlkeXZlcnNlKQoKZ2dwbG90KGFuZXMsIGFlcyh4ID0gYWdlLCB5ID0gZnR0cnVtcDEpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX3Ntb290aChtZXRob2QgPSBsbSkKCiMnIAojJyBUaGVyZSBpcyBhIHBvc2l0aXZlIHJlbGF0aW9uc2hpcC4gV2UgY2FuIGNhbGN1bGF0ZSB0aGUgZXhhY3QgbnVtZXJpY2FsIG5hdHVyZSBvZiB0aGF0IHJlbGF0aW9uc2hpcCBhcyBmb2xsb3dzOgojJyAKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KbW9kZWwxIDwtIGxtKGZ0dHJ1bXAxIH4gYWdlLCBkYXRhID0gYW5lcykKCiMnIAojJyBXZSBzdGFydCBieSBzcGVjaWZ5aW5nIGFuIG9iamVjdCBpbnRvIHdoaWNoIHdlIHN0b3JlIHRoZSByZXN1bHRzLiBUaGVuIHdlIGNhbGwgYGxtYCB3aGljaCBtZWFucyBsaW5lYXIgbW9kZWwuIE91ciBkZXBlbmRlbnQgdmFyaWFibGUgYGZ0dHJ1bXAxYCBpcyBsaXN0ZWQgZmlyc3QsIGFuZCB0aGVuIGFmdGVyIGEgdGlsZGUgdGhlIGluZGVwZW5kZW50IHZhcmlhYmxlLCBgYWdlYC4gRmluYWxseSwgd2UgdGVsbCBSIHdoaWNoIGRhdGEgc2V0IHRvIHVzZS4gV2UgY2FuIHRoZW4gcHJpbnQgdGhlIHJlc3VsdCwgYnkgY2FsbGluZyBgbW9kZWwxYC4KIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCm1vZGVsMQoKIycgCiMnIEhvdyB3b3VsZCB3ZSBpbnRlcnByZXQgdGhlc2UgcmVzdWx0cz8KIycgCiMnIC0gQXQgYW4gYWdlIG9mIHplcm8sIGEgcGVyc29uIHdvdWxkIHJhdGUgVHJ1bXAgYXQgMzEuNjggKm9uIGF2ZXJhZ2UqLiBUaGlzIG9mIGNvdXJzZSBtYWtlcyBsaXR0bGUgc2Vuc2UgaW4gYW55dGhpbmcgYnV0IGEgdGhlb3JldGljYWwgLyBtYXRoZW1hdGljYWwgY29uc2lkZXJhdGlvbi4gCiMnIC0gV2l0aCBldmVyeSBhZGRpdGlvbmFsIHllYXIgb2YgYWdlLCBhIHBlcnNvbiB3b3VsZCByYXRlIFRydW1wIDAuMjIgcG9pbnRzIGhpZ2hlciAqb24gYXZlcmFnZSouCiMnIAojJyBCdXQgYXJlIHRoZXNlIGZpbmRpbmdzIHNpZ25pZmljYW50IGF0IGFuIGFjY2VwdGFibGUgc2lnbmlmaWNhbmNlIGxldmVsPyBMZXQncyBmaW5kIG91dCwgYnkgZ2V0dGluZyBhIG1vcmUgZGV0YWlsZWQgb3V0cHV0OgojJyAKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3VtbWFyeShtb2RlbDEpCgojJyAKIycgT0ssIHRoZXJlIGlzIGEgbG90IG1vcmUgaGVyZSwgYW5kIGl0IGlzIHdvcnRoIHBhdXNpbmcgdG8gZ28gdGhyb3VnaCB0aGlzIHN0ZXAgYnkgc3RlcC4gRmlyc3QsIFIgcmVtaW5kcyB1cyBvZiB0aGUgYWN0dWFsIGZvcm11bGEgd2UgaGF2ZSB1c2VkIHRvIGVzdGltYXRlIHRoZSBtb2RlbDoKIycgCiMnIAojJyAKIycgCiMnIAojJyAKIycgSSBhbSBpZ25vcmluZyB0aGUgc2VjdGlvbiBvbiByZXNpZHVhbHMgZm9yIG5vdywgYXMgd2UgZG9uJ3QgbmVlZCB0byBtYWtlIG91ciBsaXZlcyBtb3JlIGRpZmZpY3VsdCB0aGFuIGl0IG5lZWRzIHRvIGJlLiBJIHdpbGwgY29tZSBiYWNrIHRvIHRoaXMgdW5kZXIgdGhlIFtUaGUgQ2xhc3NpY2FsIExpbmVhciBBc3N1bXB0aW9uc10uIE5vdyBjb21lIHRoZSBjb2VmZmljaWVudHM6CiMnIAojJyAKIycgCiMnIAojJyBUaGUgc2l6ZSBhbmQgZGlyZWN0aW9uIGlzIG9mIGNvdXJzZSB0aGUgc2FtZSBhcyBpbiBvdXIgcHJldmlvdXMgb3V0cHV0LCBidXQgdGhpcyBvdXRwdXQgbm93IGNvbnRhaW5zIHNvbWUgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgc3RhbmRhcmQgZXJyb3IsIHRoZSByZXN1bHRpbmcgdC12YWx1ZSwgYW5kIHRoZSBwLXZhbHVlLiBSIGlzIHZlcnkgaGVscGZ1bCBoZXJlLCBpbiB0aGF0IGl0IG9mZmVycyB1cyBhIHZhcnlpbmcgYW1vdW50IG9mIGFzdGVyaXNrcyBhY2NvcmRpbmcgdG8gZGlmZmVyZW50LCBjb21tb25seSBhY2NlcHRlZCBsZXZlbHMgb2Ygc2lnbmlmaWNhbmNlLiAwLjA1IGlzIHN0YW5kYXJkIHByYWN0aWNlIGluIHRoZSBzb2NpYWwgc2NpZW5jZXMsIHNvIHdlIHdpbGwgYWNjZXB0IGFueXRoaW5nIHdpdGggb25lLCBvciBtb3JlIGFzdGVyaXNrcy4gQm90aCBvdXIgaW50ZXJjZXB0IGFuZCB0aGUgc2xvcGUgY29lZmZpY2llbnQgYXJlIHNpZ25pZmljYW50IGF0IGEgOTUlIGNvbmZpZGVuY2UgbGV2ZWwsIHNvIHdlIGhhdmUgc2hvd24gdGhhdCB0aGVyZSBpcyBhIHN0YXRpc3RpY2FsIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGFnZSBhbmQgcmF0aW5ncyBmb3IgVHJ1bXAuIAojJyAKIycgSSBhbSBvbWl0dGluZyB0aGUgcmVzaWR1YWwgc3RhbmRhcmQgZXJyb3IgZm9yIHRoZSBzYW1lIHJlYXNvbiBhcyBiZWZvcmUsIGJ1dCBsZXQgdXMgbG9vayBhdCB0aGUgbW9kZWwgZml0IGluZGljYXRvcnMuCiMnIAojJyAKIycgCiMnIAojJyBNdWx0aXBsZSBSLVNxdWFyZWQgKGFrYSAkUl57Mn0kKSB0ZWxscyB1cyBob3cgbXVjaCB2YXJpYXRpb24gaW4gdGhlIGRlcGVuZGVudCB2YXJpYWJsZSBgZnR0cnVtcDFgIGlzIGV4cGxhaW5lZCB0aHJvdWdoIHRoZSBpbmRlcGVuZGVudCB2YXJpYWJsZSBgYWdlYC4gJFJeezJ9JCBydW5zIGJldHdlZW4gMCBhbmQgMSwgd2hlcmUgMSBpcyBlcXVhbCB0byAxMDAlIG9mIHRoZSB2YXJpYXRpb24uIEluIG91ciBjYXNlLCB3ZSBoYXZlIGV4cGxhaW5lZCBhIG1lcmUgMC4wOSUgb2YgdGhlIFRydW1wIHJhdGluZy4gVGhpcyBpcyBsb3VzeSwgYW5kIHdlIGNhbiBkbyBhIGxvdCBiZXR0ZXIgdGhhbiB0aGF0LiBOZXZlciBleHBlY3QgYW55dGhpbmcgbmVhciAxMDAlIHVubGVzcyB5b3Ugd29yayB3aXRoIGEgdG95IGRhdGEgc2V0IGZyb20gYSB0ZXh0IGJvb2suIElmIHlvdSBnZXQgNjAtNzAlIHlvdSBjYW4gYmUgdmVyeSBoYXBweS4gSSB3aWxsIHJldHVybiB0byBBZGp1c3RlZCAkUl57Mn0kIHdoZW4gaW4gdGhlIFNlY3Rpb24gb24gW011bHRpcGxlIExpbmVhciBSZWdyZXNzaW9uXS4gCiMnIAojJyBUaGUgRi1zdGF0aXN0aWMgYXQgdGhlIGVuZDoKIycgCiMnIAojJyAKIycgaXMgYSB0ZXN0IHdpdGggdGhlIG51bGwgaHlwb3RoZXNpcyB0aGF0IGFsbCBjb2VmZmljaWVudHMgb2YgdGhlIG1vZGVsIGFyZSBqb2ludGx5IHplcm8uIEluIG91ciBjYXNlLCB3ZSBjYW4gcmVqZWN0IHRoaXMgbnVsbCBoeXBvdGhlc2lzIHZlcnkgc291bmRseSwgYXMgdGhlIHAtdmFsdWUgaXMgZmFyIGJlbG93IHRoZSBjb21tb25seSBhY2NlcHRlZCBtYXhpbXVtIG9mIDUlLiAKIycgCiMnIAojJyAKIycgIyMjIyMgQ2F0ZWdvcmljYWwgSW5kZXBlbmRlbnQgVmFyaWFibGVzIChha2EgJ0R1bW1pZXMnKSAKCiMnIAojJyBPZnRlbiB2YXJpYWJsZXMgYXJlIGNhdGVnb3JpY2FsLiBPbmUgc3VjaCBleGFtcGxlIGlzIHRoZSB2YXJpYWJsZSBgc2V4YCB3aGljaCBoYXMgdHdvIGNhdGVnb3JpZXM6IG1hbGUgYW5kIGZlbWFsZS4gCiMnIAojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdW1tYXJ5KGFuZXMkc2V4KQp0YWJsZShhbmVzJHNleCkKCiMnIAojJyAKIycgVHVybiB0aGlzIGludG8gYSBmYWN0b3IgdmFyaWFibGUgYW5kIGFzc2lnbiB0ZWxsaW5nIGxhYmVscwojJyAKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KYW5lcyRzZXggPC0gZmFjdG9yKGFuZXMkc2V4LCBsYWJlbHMgPSBjKCJNYWxlIiwgIkZlbWFsZSIpKQoKIycgCiMnIENoZWNrIGlmIHRoaXMgaGFzIHdvcmtlZDoKIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnRhYmxlKGFuZXMkc2V4KQoKIycgCiMnIExldCdzIGVzdGltYXRlIHRoZSBtb2RlbDoKIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCm1vZGVsMiA8LSBsbShmdHRydW1wMSB+IHNleCwgZGF0YSA9IGFuZXMpCnN1bW1hcnkobW9kZWwyKQoKIycgCiMnIEhvdyBkbyB3ZSBpbnRlcnByZXQgdGhpcz8KIycgCiMnIC0gTGV0J3MgZG8gdGhlIHNsb3BlIGNvZWZmaWNpZW50IGZpcnN0OiBhIHdvbWVuIHdvdWxkIHJhdGUgVHJ1bXAgYXQgNy4xNiBwb2ludHMgbGVzcyB0aGFuIGEgbWFuIG9uIGF2ZXJhZ2UuIFRoZSBpbnRlcnByZXRhdGlvbiBvZiBhIGR1bW15IHZhcmlhYmxlIGNvZWZmaWNpZW50IGlzIGRvbmUgd2l0aCByZWdhcmRzIHRvIHRoZSByZWZlcmVuY2UgY2F0ZWdvcnkuIEluIG91ciBjYXNlIHRoaXMgaXMgIm1hbGUiLiBTbyB0aGUgZWZmZWN0IHdlIG9ic2VydmUgaGVyZSBpcyBlcXVpdmFsZW50IG9mIG1vdmluZyBmcm9tICJtYWxlIiB0byAiZmVtYWxlIiBhbmQgdGhhdCBlZmZlY3QgYWRkcyA3LjE2IHBvaW50cy4KIycgLSBUaGlzIGdpdmVzIHlvdSBhbiBpbmRpY2F0aW9uIG9mIGhvdyB0byBpbnRlcnByZXQgdGhlIGludGVyY2VwdCBpbiB0aGlzIGNhc2U6IFRoZSB2YWx1ZSBkaXNwbGF5ZWQgaXMgaG93IG1lbiB3b3VsZCByYXRlIFRydW1wIG9uIGF2ZXJhZ2UsIG5hbWVseSBhdCA0Ni4xNiBwb2ludHMuIEFsbCBvZiB0aGlzIGlzIHNpZ25pZmljYW50IGF0IGEgOTUlIGNvbmZpZGVuY2UgbGV2ZWwuIAojJyAKIycgVGhpcyBlZmZlY3QgY29ycm9ib3JhdGVzIHRoZSBoeXBvdGhlc2lzIGFkdmFuY2VkIGJ5IEluZ2xlaGFydCBhbmQgTm9ycmlzLCBidXQgdGhlIHJlc3VsdHMgYXJlIG5vdCBkaXNwbGF5ZWQgaW4gdGhlIG1vc3QgZWxlZ2FudCB3YXkuIFRoZSBzZXggdGhlc2UgYXV0aG9ycyBtYWRlIGEgc3RhdGVtZW50IGFib3V0IHdlcmUgbWVuLiBTbyB3ZSBuZWVkIHRvIGNoYW5nZSB0aGUgcmVmZXJlbmNlIGNhdGVnb3J5IHRvICJmZW1hbGUiLgojJyAKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KYW5lcyA8LSBhbmVzICU+JQogIG11dGF0ZShzZXggPSByZWxldmVsKHNleCwgcmVmID0gIkZlbWFsZSIpKQoKIycgCiMnIFdoZW4gd2UgcmUtZXN0aW1hdGUgdGhlIG1vZGVsLCB3ZSBnZXQgdGhlIGVmZmVjdCBkaXNwbGF5ZWQgZGlyZWN0bHk6CiMnIAojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQptb2RlbDIgPC0gbG0oZnR0cnVtcDEgfiBzZXgsIGRhdGEgPSBhbmVzKQpzdW1tYXJ5KG1vZGVsMikKCiMnIAojJyAKIycgV2hpbHN0IG1hbnkgY2F0ZWdvcmljYWwgdmFyaWFibGVzIGFyZSBiaW5hcnksIG9mIGNvdXJzZSBub3QgYWxsIG9mIHRoZW0gYXJlLiBTbyBob3cgZG9lcyB0aGlzIHdvcmsgd2l0aCBhIGNhdGVnb3JpY2FsIHZhcmlhYmxlIHdpdGggMyBvciBtb3JlIGxldmVscz8KIycgCiMnIFRoZSBuZXh0IGRldGVybWluYW50IG1lbnRpb25lZCBpbiBJbmdsZWhhcnQgYW5kIE5vcnJpcycgcGFwZXIgaXMgZWR1Y2F0aW9uLiBXZSBjYW4gb2J0YWluIGluZm9ybWF0aW9uIGFib3V0IGEgcmVzcG9uZGVudCdzIGxldmVsIG9mIGVkdWNhdGlvbiB3aXRoIHRoZSB2YXJpYWJsZSBgZWR1Y2AuIAojJyAKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3VtbWFyeShhbmVzJGVkdWMpCnRhYmxlKGFuZXMkZWR1YykKCiMnIAojJyBUaGlzIGlzIG5vdCB0ZXJyaWJseSB0ZWxsaW5nIGluIGl0c2VsZiwgeWV0LCBzbyBsZXQncyBoYXZlIGEgbG9vayBhdCB0aGUgY29kZWJvb2s6CiMnIAojJyAKIycge3dpZHRoPTUwJX0KIycgCiMnIFRoZSBmaXJzdCBzdGVwIGlzLCBhcyBiZWZvcmUgdG8gcmVjb2RlIHRoaXMgdmFyaWFibGUgaW50byBhIGZhY3RvciB2YXJpYWJsZToKIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFuZXMkZWR1YyA8LSBmYWN0b3IoYW5lcyRlZHVjKQoKIycgCiMnIEVpZ2h0IGxldmVscyBhcmUgdG9vIG1hbnkgaGVyZSB0byBkbyBhbnkgbWVhbmluZ2Z1bCBhbmFseXNpcywgYW5kIHR3byB3b3VsZCBiZSB0b28gcmVkdWN0aW9uaXN0LiBGb3Igc2FrZSBvZiBzaW1wbGljaXR5LCBsZXQncyBnbyB3aXRoIHRocmVlOiBsb3csIG1lZGl1bSBhbmQgaGlnaCBlZHVjYXRpb24uIFdlIHJlY29kZSBpbnRvIGFuIG9yZGVyZWQgZmFjdG9yIGFzIGZvbGxvd3M6CiMnIAojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQphbmVzIDwtIGFuZXMgJT4lCiAgbXV0YXRlKGVkdWNfZmFjID0gcmVjb2RlKGVkdWMsICcxJz0ibG93IiwgCiAgICAgICAgICAgICAgICAgICAgICAgJzInPSAibG93IiwKICAgICAgICAgICAgICAgICAgICAgICAnMyc9ICJsb3ciLAogICAgICAgICAgICAgICAgICAgICAgICc0JyA9ICJtZWRpdW0iLAogICAgICAgICAgICAgICAgICAgICAgICc1JyA9ICJtZWRpdW0iLAogICAgICAgICAgICAgICAgICAgICAgICc2JyA9ICJoaWdoIiwKICAgICAgICAgICAgICAgICAgICAgICAnNycgPSAiaGlnaCIsCiAgICAgICAgICAgICAgICAgICAgICAgJzgnID0gImhpZ2giKSkKCiMnIAojJyBDaGVjayB0aGUgcmVzdWx0czoKIycgCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnRhYmxlKGFuZXMkZWR1Y19mYWMpCgojJyAKIycgCiMnIEFuZCB3ZSBhcmUgcmVhZHkgdG8gZ286CiMnIAojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQptb2RlbDMgPC0gbG0oZnR0cnVtcDEgfiBlZHVjX2ZhYywgZGF0YSA9IGFuZXMpCnN1bW1hcnkobW9kZWwzKQoKIycgCiMnIFdoaWxzdCB0aGUgaW50ZXJjZXB0IGlzIHN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQsIHRoZSBzbG9wZSBjb2VmZmljaWVudHMgYXJlIG5vdC4gVGhlcmVmb3JlLCB3ZSBjYW4gY29uY2x1ZGUgdGhhdCBlZHVjYXRpb24gaGFzIG5vIHN0YXRpc3RpY2FsIGluZmx1ZW5jZSBvbiBUcnVtcCdzIGFwcHJvdmFsIHJhdGluZ3MuIAojJyAKIycgTm90ZSwgdGhhdCBhcyBpbiB0aGUgc2V4IGV4YW1wbGUgYmVmb3JlLCBSIGhhcyBjaG9zZSB0aGUgZmlyc3QgbGV2ZWwgb2YgdGhlIGluZGVwZW5kZW50IHZhcmlhYmxlIGFzIHRoZSByZWZlcmVuY2UgY2F0ZWdvcnkuIElmIHlvdSB3aXNoIHRvIGNoYW5nZSB0aGlzLCB5b3UgY2FuIGRvIHNvIGluIHRoZSBzYW1lIG1hbm5lciBhcyBiZWZvcmUuIFlvdSBjYW4gYWxzbyBjaGVjayB3aGljaCBsZXZlbCBSIGhhcyB1c2VkIGFzIHRoZSByZWZlcmVuY2UgY2F0ZWdvcnkgd2l0aCB0aGUgYGNvbnRyYXN0cygpYCBjb21tYW5kLiBIZXJlOgojJyAKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY29udHJhc3RzKGFuZXMkZWR1Y19mYWMpCgojJyAKIycgCiMnICMjIwojJyAKIycgCiMnIAojJyAKIycgIyMgUmVmZXJlbmNlcwojJyAKIycgSW5nbGVoYXJ0LCBSb25hbGQgRi4gYW5kIE5vcnJpcywgUGlwcGEgKDIwMTYpIFRydW1wLCBCcmV4aXQsIGFuZCB0aGUgUmlzZSBvZiBQb3B1bGlzbTogRWNvbm9taWMgSGF2ZS1Ob3RzIGFuZCBDdWx0dXJhbCBCYWNrbGFzaC4gSEtTIFdvcmtpbmcgUGFwZXIgTm8uIFJXUDE2LTAyNiwgQXZhaWxhYmxlIGF0IFNTUk46IGh0dHBzOi8vc3Nybi5jb20vYWJzdHJhY3Q9MjgxODY1OSBvciBodHRwOi8vZHguZG9pLm9yZy8xMC4yMTM5L3Nzcm4uMjgxODY1OQoA" download="09-ols.R">
<button class="btn btn-default"><i class="fa fa-save"></i> Chapter script</button>
</a><a href="data:text/x-markdown;base64,LS0tCm91dHB1dDogaHRtbF9kb2N1bWVudAotLS0KIyBMaW5lYXIgUmVncmVzc2lvbiB7I29sc30KCgoKCiMjIENvbnRlbnQKCjxjZW50ZXI+IF9fU2l0ZSBzdGlsbCB1bmRlciBjb25zdHJ1Y3Rpb24hX18gPC9jZW50ZXI+CgojIyMgSW50cm9kdWN0aW9uIHstfQoKCkRhdGEgYXJlIHRha2VuIGZyb20gaHR0cHM6Ly9lbGVjdGlvbnN0dWRpZXMub3JnL2RhdGEtY2VudGVyLzIwMjAtZXhwbG9yYXRvcnktdGVzdGluZy1zdXJ2ZXkvIHRvIG1vZGVsIHRoZSBmZWVsaW5ncyB0b3dhcmRzIERvbmFsZCBUcnVtcCBpbiB0aGUgbGVhZC11cCB0byB0aGUgcHJlc2lkZW50aWFsIGVsZWN0aW9uIDIwMjAuCgoKCiMjIyBCaXZhcmlhdGUgTGluZWFyIFJlZ3Jlc3Npb24gey19CgojIyMjIFRoZSBUaGVvcnkgey19CgojIyMjIFRoZSBBcHBsaWNhdGlvbiB7LX0KCldlIGFyZSB1c2luZyB0aGUgIjIwMjAgRXhwbG9yYXRvcnkgVGVzdGluZyBTdXJ2ZXkiCgpMb2FkIHRoZSBBTkVTIGRhdGEgc2V0CgpgYGB7cn0KYW5lcyA8LSByZWFkLmNzdigiZGF0YS9hbmVzLmNzdiIpCmBgYAoKCmBgYHtyfQpzdW1tYXJ5KGFuZXMkZnR0cnVtcDEpCmBgYAoKVGhpcyBpcyBubyBnb29kLCBhcyB0aGUgdmFyaWFibGUgaXMgYm91bmRlZCBiZXR3ZWVuIDAgYW5kIDEwMC4gSW4gZmFjdCA5OTkgaXMgYSBwbGFjZWhvbGRlciBmb3IgbWlzc2luZyBkYXRhIHRocm91Z2hvdXQgdGhlIGRhdGEgc2V0LiBXZSBuZWVkIHRvIHJlcGxhY2UgdGhpcyB3aXRoIE5Bcy4KCmBgYHtyfQphbmVzW2FuZXMgPT0gOTk5XSA8LSBOQQpgYGAKCklmIHdlIGxvb2sgYXQgdGhlIHN1bW1hcnkgYWdhaW4sIGV2ZXJ5dGhpbmcgbG9va3MgZmluZSBub3c6CgpgYGB7cn0Kc3VtbWFyeShhbmVzJGZ0dHJ1bXAxKQpgYGAKCkJ5IHRoZSB3YXksIGhhZCB5b3UganVzdCB3YW50ZWQgdG8gcmVwbGFjZSB0aGlzIGluIG9uZSB2YXJpYWJsZSwgZm9yIGV4YW1wbGUgb25seSBpbiBgZnR0cnVtcDFgLCB5b3UgY291bGQgaGF2ZSBjYWxsZWQ6CgpgYGB7ciBldmFsPUZBTFNFfQphbmVzJGZ0dHJ1bXAxIDwtIHdpdGgoYW5lcywgcmVwbGFjZShmdHRydW1wMSwgZnR0cnVtcDEgPT0gOTk5LCBOQSkpCmBgYAoKTm9ycmlzIGFuZCBJbmdsZWhhcnQgKDIwMTYpIGhhdmUgYXJndWVkIHRoYXQ6Cgo+cG9wdWxpc3Qgc3VwcG9ydCBpbiBFdXJvcGUgaXMgZ2VuZXJhbGx5IHN0cm9uZ2VyIGFtb25nIHRoZSBvbGRlciBnZW5lcmF0aW9uLCBtZW4sIHRoZSBsZXNzIGVkdWNhdGVkLCB0aGUgcmVsaWdpb3VzLCBhbmQgZXRobmljIG1ham9yaXRpZXMsIHBhdHRlcm5zIGNvbmZpcm1pbmcgcHJldmlvdXMgcmVzZWFyY2guCgpMZXQncyBzZWUgaWYgdGhpcyBhbHNvIGFwcGxpZXMgdG8gcHJlc2lkZW50aWFsIGVsZWN0aW9ucyBpbiB0aGUgVVMuIFdlIGZpcnN0IGxvb2sgYXQgdGhlIHF1ZXN0aW9uOiAiRG8gb2xkZXIgcGVvcGxlIHJhdGUgVHJ1bXAgaGlnaGVyIHRoYW4geW91bmdlciBwZW9wbGU/Ii4gT3VyIGluZGVwZW5kZW50IHZhcmlhYmxlcyBpcyBgYWdlYC4KCmBgYHtyfQpzdW1tYXJ5KGFuZXMkYWdlKQpgYGAKCkxldCdzIGV2YWx1YXRlIHRoZSByZWxhdGlvbnNoaXAgdGhyb3VnaCBhIHNjYXR0ZXIgcGxvdCB3aXRoIGEgbGluZSBvZiBiZXN0IGZpdDoKCmBgYHtyIHdhcm5pbmc9RkFMU0UsIG1lc3NhZ2U9RkFMU0V9CmxpYnJhcnkodGlkeXZlcnNlKQoKZ2dwbG90KGFuZXMsIGFlcyh4ID0gYWdlLCB5ID0gZnR0cnVtcDEpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX3Ntb290aChtZXRob2QgPSBsbSkKYGBgCgpUaGVyZSBpcyBhIHBvc2l0aXZlIHJlbGF0aW9uc2hpcC4gV2UgY2FuIGNhbGN1bGF0ZSB0aGUgZXhhY3QgbnVtZXJpY2FsIG5hdHVyZSBvZiB0aGF0IHJlbGF0aW9uc2hpcCBhcyBmb2xsb3dzOgoKYGBge3J9Cm1vZGVsMSA8LSBsbShmdHRydW1wMSB+IGFnZSwgZGF0YSA9IGFuZXMpCmBgYAoKV2Ugc3RhcnQgYnkgc3BlY2lmeWluZyBhbiBvYmplY3QgaW50byB3aGljaCB3ZSBzdG9yZSB0aGUgcmVzdWx0cy4gVGhlbiB3ZSBjYWxsIGBsbWAgd2hpY2ggbWVhbnMgbGluZWFyIG1vZGVsLiBPdXIgZGVwZW5kZW50IHZhcmlhYmxlIGBmdHRydW1wMWAgaXMgbGlzdGVkIGZpcnN0LCBhbmQgdGhlbiBhZnRlciBhIHRpbGRlIHRoZSBpbmRlcGVuZGVudCB2YXJpYWJsZSwgYGFnZWAuIEZpbmFsbHksIHdlIHRlbGwgUiB3aGljaCBkYXRhIHNldCB0byB1c2UuIFdlIGNhbiB0aGVuIHByaW50IHRoZSByZXN1bHQsIGJ5IGNhbGxpbmcgYG1vZGVsMWAuCgpgYGB7cn0KbW9kZWwxCmBgYAoKSG93IHdvdWxkIHdlIGludGVycHJldCB0aGVzZSByZXN1bHRzPwoKLSBBdCBhbiBhZ2Ugb2YgemVybywgYSBwZXJzb24gd291bGQgcmF0ZSBUcnVtcCBhdCAzMS42OCAqb24gYXZlcmFnZSouIFRoaXMgb2YgY291cnNlIG1ha2VzIGxpdHRsZSBzZW5zZSBpbiBhbnl0aGluZyBidXQgYSB0aGVvcmV0aWNhbCAvIG1hdGhlbWF0aWNhbCBjb25zaWRlcmF0aW9uLiAKLSBXaXRoIGV2ZXJ5IGFkZGl0aW9uYWwgeWVhciBvZiBhZ2UsIGEgcGVyc29uIHdvdWxkIHJhdGUgVHJ1bXAgMC4yMiBwb2ludHMgaGlnaGVyICpvbiBhdmVyYWdlKi4KCkJ1dCBhcmUgdGhlc2UgZmluZGluZ3Mgc2lnbmlmaWNhbnQgYXQgYW4gYWNjZXB0YWJsZSBzaWduaWZpY2FuY2UgbGV2ZWw/IExldCdzIGZpbmQgb3V0LCBieSBnZXR0aW5nIGEgbW9yZSBkZXRhaWxlZCBvdXRwdXQ6CgpgYGB7cn0Kc3VtbWFyeShtb2RlbDEpCmBgYAoKT0ssIHRoZXJlIGlzIGEgbG90IG1vcmUgaGVyZSwgYW5kIGl0IGlzIHdvcnRoIHBhdXNpbmcgdG8gZ28gdGhyb3VnaCB0aGlzIHN0ZXAgYnkgc3RlcC4gRmlyc3QsIFIgcmVtaW5kcyB1cyBvZiB0aGUgYWN0dWFsIGZvcm11bGEgd2UgaGF2ZSB1c2VkIHRvIGVzdGltYXRlIHRoZSBtb2RlbDoKCgoKCgoKSSBhbSBpZ25vcmluZyB0aGUgc2VjdGlvbiBvbiByZXNpZHVhbHMgZm9yIG5vdywgYXMgd2UgZG9uJ3QgbmVlZCB0byBtYWtlIG91ciBsaXZlcyBtb3JlIGRpZmZpY3VsdCB0aGFuIGl0IG5lZWRzIHRvIGJlLiBJIHdpbGwgY29tZSBiYWNrIHRvIHRoaXMgdW5kZXIgdGhlIFtUaGUgQ2xhc3NpY2FsIExpbmVhciBBc3N1bXB0aW9uc10uIE5vdyBjb21lIHRoZSBjb2VmZmljaWVudHM6CgoKCgpUaGUgc2l6ZSBhbmQgZGlyZWN0aW9uIGlzIG9mIGNvdXJzZSB0aGUgc2FtZSBhcyBpbiBvdXIgcHJldmlvdXMgb3V0cHV0LCBidXQgdGhpcyBvdXRwdXQgbm93IGNvbnRhaW5zIHNvbWUgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgc3RhbmRhcmQgZXJyb3IsIHRoZSByZXN1bHRpbmcgdC12YWx1ZSwgYW5kIHRoZSBwLXZhbHVlLiBSIGlzIHZlcnkgaGVscGZ1bCBoZXJlLCBpbiB0aGF0IGl0IG9mZmVycyB1cyBhIHZhcnlpbmcgYW1vdW50IG9mIGFzdGVyaXNrcyBhY2NvcmRpbmcgdG8gZGlmZmVyZW50LCBjb21tb25seSBhY2NlcHRlZCBsZXZlbHMgb2Ygc2lnbmlmaWNhbmNlLiAwLjA1IGlzIHN0YW5kYXJkIHByYWN0aWNlIGluIHRoZSBzb2NpYWwgc2NpZW5jZXMsIHNvIHdlIHdpbGwgYWNjZXB0IGFueXRoaW5nIHdpdGggb25lLCBvciBtb3JlIGFzdGVyaXNrcy4gQm90aCBvdXIgaW50ZXJjZXB0IGFuZCB0aGUgc2xvcGUgY29lZmZpY2llbnQgYXJlIHNpZ25pZmljYW50IGF0IGEgOTUlIGNvbmZpZGVuY2UgbGV2ZWwsIHNvIHdlIGhhdmUgc2hvd24gdGhhdCB0aGVyZSBpcyBhIHN0YXRpc3RpY2FsIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGFnZSBhbmQgcmF0aW5ncyBmb3IgVHJ1bXAuIAoKSSBhbSBvbWl0dGluZyB0aGUgcmVzaWR1YWwgc3RhbmRhcmQgZXJyb3IgZm9yIHRoZSBzYW1lIHJlYXNvbiBhcyBiZWZvcmUsIGJ1dCBsZXQgdXMgbG9vayBhdCB0aGUgbW9kZWwgZml0IGluZGljYXRvcnMuCgoKCgpNdWx0aXBsZSBSLVNxdWFyZWQgKGFrYSAkUl57Mn0kKSB0ZWxscyB1cyBob3cgbXVjaCB2YXJpYXRpb24gaW4gdGhlIGRlcGVuZGVudCB2YXJpYWJsZSBgZnR0cnVtcDFgIGlzIGV4cGxhaW5lZCB0aHJvdWdoIHRoZSBpbmRlcGVuZGVudCB2YXJpYWJsZSBgYWdlYC4gJFJeezJ9JCBydW5zIGJldHdlZW4gMCBhbmQgMSwgd2hlcmUgMSBpcyBlcXVhbCB0byAxMDAlIG9mIHRoZSB2YXJpYXRpb24uIEluIG91ciBjYXNlLCB3ZSBoYXZlIGV4cGxhaW5lZCBhIG1lcmUgMC4wOSUgb2YgdGhlIFRydW1wIHJhdGluZy4gVGhpcyBpcyBsb3VzeSwgYW5kIHdlIGNhbiBkbyBhIGxvdCBiZXR0ZXIgdGhhbiB0aGF0LiBOZXZlciBleHBlY3QgYW55dGhpbmcgbmVhciAxMDAlIHVubGVzcyB5b3Ugd29yayB3aXRoIGEgdG95IGRhdGEgc2V0IGZyb20gYSB0ZXh0IGJvb2suIElmIHlvdSBnZXQgNjAtNzAlIHlvdSBjYW4gYmUgdmVyeSBoYXBweS4gSSB3aWxsIHJldHVybiB0byBBZGp1c3RlZCAkUl57Mn0kIHdoZW4gaW4gdGhlIFNlY3Rpb24gb24gW011bHRpcGxlIExpbmVhciBSZWdyZXNzaW9uXS4gCgpUaGUgRi1zdGF0aXN0aWMgYXQgdGhlIGVuZDoKCgoKaXMgYSB0ZXN0IHdpdGggdGhlIG51bGwgaHlwb3RoZXNpcyB0aGF0IGFsbCBjb2VmZmljaWVudHMgb2YgdGhlIG1vZGVsIGFyZSBqb2ludGx5IHplcm8uIEluIG91ciBjYXNlLCB3ZSBjYW4gcmVqZWN0IHRoaXMgbnVsbCBoeXBvdGhlc2lzIHZlcnkgc291bmRseSwgYXMgdGhlIHAtdmFsdWUgaXMgZmFyIGJlbG93IHRoZSBjb21tb25seSBhY2NlcHRlZCBtYXhpbXVtIG9mIDUlLiAKCgoKIyMjIyMgQ2F0ZWdvcmljYWwgSW5kZXBlbmRlbnQgVmFyaWFibGVzIChha2EgJ0R1bW1pZXMnKSB7LX0KCk9mdGVuIHZhcmlhYmxlcyBhcmUgY2F0ZWdvcmljYWwuIE9uZSBzdWNoIGV4YW1wbGUgaXMgdGhlIHZhcmlhYmxlIGBzZXhgIHdoaWNoIGhhcyB0d28gY2F0ZWdvcmllczogbWFsZSBhbmQgZmVtYWxlLiAKCmBgYHtyfQpzdW1tYXJ5KGFuZXMkc2V4KQp0YWJsZShhbmVzJHNleCkKYGBgCgoKVHVybiB0aGlzIGludG8gYSBmYWN0b3IgdmFyaWFibGUgYW5kIGFzc2lnbiB0ZWxsaW5nIGxhYmVscwoKYGBge3J9CmFuZXMkc2V4IDwtIGZhY3RvcihhbmVzJHNleCwgbGFiZWxzID0gYygiTWFsZSIsICJGZW1hbGUiKSkKYGBgCgpDaGVjayBpZiB0aGlzIGhhcyB3b3JrZWQ6CgpgYGB7cn0KdGFibGUoYW5lcyRzZXgpCmBgYAoKTGV0J3MgZXN0aW1hdGUgdGhlIG1vZGVsOgoKYGBge3J9Cm1vZGVsMiA8LSBsbShmdHRydW1wMSB+IHNleCwgZGF0YSA9IGFuZXMpCnN1bW1hcnkobW9kZWwyKQpgYGAKCkhvdyBkbyB3ZSBpbnRlcnByZXQgdGhpcz8KCi0gTGV0J3MgZG8gdGhlIHNsb3BlIGNvZWZmaWNpZW50IGZpcnN0OiBhIHdvbWVuIHdvdWxkIHJhdGUgVHJ1bXAgYXQgNy4xNiBwb2ludHMgbGVzcyB0aGFuIGEgbWFuIG9uIGF2ZXJhZ2UuIFRoZSBpbnRlcnByZXRhdGlvbiBvZiBhIGR1bW15IHZhcmlhYmxlIGNvZWZmaWNpZW50IGlzIGRvbmUgd2l0aCByZWdhcmRzIHRvIHRoZSByZWZlcmVuY2UgY2F0ZWdvcnkuIEluIG91ciBjYXNlIHRoaXMgaXMgIm1hbGUiLiBTbyB0aGUgZWZmZWN0IHdlIG9ic2VydmUgaGVyZSBpcyBlcXVpdmFsZW50IG9mIG1vdmluZyBmcm9tICJtYWxlIiB0byAiZmVtYWxlIiBhbmQgdGhhdCBlZmZlY3QgYWRkcyA3LjE2IHBvaW50cy4KLSBUaGlzIGdpdmVzIHlvdSBhbiBpbmRpY2F0aW9uIG9mIGhvdyB0byBpbnRlcnByZXQgdGhlIGludGVyY2VwdCBpbiB0aGlzIGNhc2U6IFRoZSB2YWx1ZSBkaXNwbGF5ZWQgaXMgaG93IG1lbiB3b3VsZCByYXRlIFRydW1wIG9uIGF2ZXJhZ2UsIG5hbWVseSBhdCA0Ni4xNiBwb2ludHMuIEFsbCBvZiB0aGlzIGlzIHNpZ25pZmljYW50IGF0IGEgOTUlIGNvbmZpZGVuY2UgbGV2ZWwuIAoKVGhpcyBlZmZlY3QgY29ycm9ib3JhdGVzIHRoZSBoeXBvdGhlc2lzIGFkdmFuY2VkIGJ5IEluZ2xlaGFydCBhbmQgTm9ycmlzLCBidXQgdGhlIHJlc3VsdHMgYXJlIG5vdCBkaXNwbGF5ZWQgaW4gdGhlIG1vc3QgZWxlZ2FudCB3YXkuIFRoZSBzZXggdGhlc2UgYXV0aG9ycyBtYWRlIGEgc3RhdGVtZW50IGFib3V0IHdlcmUgbWVuLiBTbyB3ZSBuZWVkIHRvIGNoYW5nZSB0aGUgcmVmZXJlbmNlIGNhdGVnb3J5IHRvICJmZW1hbGUiLgoKYGBge3J9CmFuZXMgPC0gYW5lcyAlPiUKICBtdXRhdGUoc2V4ID0gcmVsZXZlbChzZXgsIHJlZiA9ICJGZW1hbGUiKSkKYGBgCgpXaGVuIHdlIHJlLWVzdGltYXRlIHRoZSBtb2RlbCwgd2UgZ2V0IHRoZSBlZmZlY3QgZGlzcGxheWVkIGRpcmVjdGx5OgoKYGBge3J9Cm1vZGVsMiA8LSBsbShmdHRydW1wMSB+IHNleCwgZGF0YSA9IGFuZXMpCnN1bW1hcnkobW9kZWwyKQpgYGAKCgpXaGlsc3QgbWFueSBjYXRlZ29yaWNhbCB2YXJpYWJsZXMgYXJlIGJpbmFyeSwgb2YgY291cnNlIG5vdCBhbGwgb2YgdGhlbSBhcmUuIFNvIGhvdyBkb2VzIHRoaXMgd29yayB3aXRoIGEgY2F0ZWdvcmljYWwgdmFyaWFibGUgd2l0aCAzIG9yIG1vcmUgbGV2ZWxzPwoKVGhlIG5leHQgZGV0ZXJtaW5hbnQgbWVudGlvbmVkIGluIEluZ2xlaGFydCBhbmQgTm9ycmlzJyBwYXBlciBpcyBlZHVjYXRpb24uIFdlIGNhbiBvYnRhaW4gaW5mb3JtYXRpb24gYWJvdXQgYSByZXNwb25kZW50J3MgbGV2ZWwgb2YgZWR1Y2F0aW9uIHdpdGggdGhlIHZhcmlhYmxlIGBlZHVjYC4gCgpgYGB7cn0Kc3VtbWFyeShhbmVzJGVkdWMpCnRhYmxlKGFuZXMkZWR1YykKYGBgCgpUaGlzIGlzIG5vdCB0ZXJyaWJseSB0ZWxsaW5nIGluIGl0c2VsZiwgeWV0LCBzbyBsZXQncyBoYXZlIGEgbG9vayBhdCB0aGUgY29kZWJvb2s6CgoKe3dpZHRoPTUwJX0KClRoZSBmaXJzdCBzdGVwIGlzLCBhcyBiZWZvcmUgdG8gcmVjb2RlIHRoaXMgdmFyaWFibGUgaW50byBhIGZhY3RvciB2YXJpYWJsZToKCmBgYHtyfQphbmVzJGVkdWMgPC0gZmFjdG9yKGFuZXMkZWR1YykKYGBgCgpFaWdodCBsZXZlbHMgYXJlIHRvbyBtYW55IGhlcmUgdG8gZG8gYW55IG1lYW5pbmdmdWwgYW5hbHlzaXMsIGFuZCB0d28gd291bGQgYmUgdG9vIHJlZHVjdGlvbmlzdC4gRm9yIHNha2Ugb2Ygc2ltcGxpY2l0eSwgbGV0J3MgZ28gd2l0aCB0aHJlZTogbG93LCBtZWRpdW0gYW5kIGhpZ2ggZWR1Y2F0aW9uLiBXZSByZWNvZGUgaW50byBhbiBvcmRlcmVkIGZhY3RvciBhcyBmb2xsb3dzOgoKYGBge3J9CmFuZXMgPC0gYW5lcyAlPiUKICBtdXRhdGUoZWR1Y19mYWMgPSByZWNvZGUoZWR1YywgJzEnPSJsb3ciLCAKICAgICAgICAgICAgICAgICAgICAgICAnMic9ICJsb3ciLAogICAgICAgICAgICAgICAgICAgICAgICczJz0gImxvdyIsCiAgICAgICAgICAgICAgICAgICAgICAgJzQnID0gIm1lZGl1bSIsCiAgICAgICAgICAgICAgICAgICAgICAgJzUnID0gIm1lZGl1bSIsCiAgICAgICAgICAgICAgICAgICAgICAgJzYnID0gImhpZ2giLAogICAgICAgICAgICAgICAgICAgICAgICc3JyA9ICJoaWdoIiwKICAgICAgICAgICAgICAgICAgICAgICAnOCcgPSAiaGlnaCIpKQpgYGAKCkNoZWNrIHRoZSByZXN1bHRzOgoKYGBge3J9CnRhYmxlKGFuZXMkZWR1Y19mYWMpCmBgYAoKCkFuZCB3ZSBhcmUgcmVhZHkgdG8gZ286CgpgYGB7cn0KbW9kZWwzIDwtIGxtKGZ0dHJ1bXAxIH4gZWR1Y19mYWMsIGRhdGEgPSBhbmVzKQpzdW1tYXJ5KG1vZGVsMykKYGBgCgpXaGlsc3QgdGhlIGludGVyY2VwdCBpcyBzdGF0aXN0aWNhbGx5IHNpZ25pZmljYW50LCB0aGUgc2xvcGUgY29lZmZpY2llbnRzIGFyZSBub3QuIFRoZXJlZm9yZSwgd2UgY2FuIGNvbmNsdWRlIHRoYXQgZWR1Y2F0aW9uIGhhcyBubyBzdGF0aXN0aWNhbCBpbmZsdWVuY2Ugb24gVHJ1bXAncyBhcHByb3ZhbCByYXRpbmdzLiAKCk5vdGUsIHRoYXQgYXMgaW4gdGhlIHNleCBleGFtcGxlIGJlZm9yZSwgUiBoYXMgY2hvc2UgdGhlIGZpcnN0IGxldmVsIG9mIHRoZSBpbmRlcGVuZGVudCB2YXJpYWJsZSBhcyB0aGUgcmVmZXJlbmNlIGNhdGVnb3J5LiBJZiB5b3Ugd2lzaCB0byBjaGFuZ2UgdGhpcywgeW91IGNhbiBkbyBzbyBpbiB0aGUgc2FtZSBtYW5uZXIgYXMgYmVmb3JlLiBZb3UgY2FuIGFsc28gY2hlY2sgd2hpY2ggbGV2ZWwgUiBoYXMgdXNlZCBhcyB0aGUgcmVmZXJlbmNlIGNhdGVnb3J5IHdpdGggdGhlIGBjb250cmFzdHMoKWAgY29tbWFuZC4gSGVyZToKCmBgYHtyfQpjb250cmFzdHMoYW5lcyRlZHVjX2ZhYykKYGBgCgoKIyMjIyMgU3VtbWFyeSBmb3IgQml2YXJpYXRlIFJlZ3Jlc3Npb24gey19CgpBbmQgdGhhdCdzIGl0ISBZb3UgaGF2ZSBtYWRlIHRoZSBmaXJzdCBiaWcgc3RlcCB0byB1bmRlcnN0YW5kaW5nIHJlZ3Jlc3Npb24gb3V0cHV0IGFuZCBwcm9kdWNpbmcgc3VjaCBvdXRwdXQgeW91cnNlbGYuIEJ1dCBub3Qgb25seSBoYXMgb3VyIGBhZ2VgIHZhcmlhYmxlIGJlZW4gcnViYmlzaCBpbiBleHBsYWluaW5nIFRydW1wIHJhdGluZ3MsIGJ1dCBhbHNvIGV4cGxhbmF0aW9ucyBpbiB0aGUgcmVhbCB3b3JsZCBhcmUgbmV2ZXIgbW9uby1jYXVzYWwuIFRoZXJlIGFyZSBhbHdheXMgbXVsdGlwbGUgaW5mbHVlbmNlcyB3b3JraW5nIGF0IHRoZSBzYW1lIHRpbWUsIGFuZCB3ZSBuZWVkIHRvIHNldCB1cCBvdXIgc3RhdGlzdGljYWwgbW9kZWwgdG8gdGFrZSB0aGlzIGNvbXBsZXhpdHkgaW50byBhY2NvdW50LiBXaGljaCBicmluZ3MgdXMgdG8gdGhlIG5leHQgc3RlcDogbXVsdGlwbGUgcmVncmVzc2lvbi4gCgoKIyMjIE11bHRpcGxlIExpbmVhciBSZWdyZXNzaW9uIHstfQoKIyMjIyBUaGUgVGhlb3J5IHstfQoKCgoKCiMjIyMgVGhlIEFwcGxpY2F0aW9uIHstfQoKCgoKIyMjIFRoZSBDbGFzc2ljYWwgTGluZWFyIEFzc3VtcHRpb25zIHstfQoKIyMjIyBGdW5jdGlvbmFsIEZvcm0gey19CgojIyMjIEZpeGVkIHgtdmFsdWVzIHstfQoKSW5kZXBlbmRlbmNlIG9mIGVycm9yIHRlcm0gZnJvbSB4LCBSYW1zZXlzIFJlc2V0IFRlc3QKCiMjIyMgWmVybyBNZWFuIFZhbHVlIG9mIERpc3R1cmJhbmNlIHstfQoKIyMjIyBIb21vc2NlZGFzdGljaXR5IHstfQoKIyMjIyBObyBBdXRvY29ycmVsYXRpb24gYmV0d2VlbiBFcnJvcnMgey19CgojIyMjIE5vIE11bHRpY29sbGluZWFyaXR5IHstfQoKIyMjIyBUaGUgTnVtYmVyIG9mIE9ic2VydmF0aW9ucyB7LX0KCi4uLiBuIG11c3QgYmUgZ3JlYXRlciB0aGFuIHRoZSBOdW1iZXIgb2YKUGFyYW1ldGVycyB0byBiZSBlc3RpbWF0ZWQKCgojIyBTdW1tYXJ5CgotICpPTFMqIGlzIGFuIGFjcm9ueW0gZm9yICJPcmRpbmFyeSBMZWFzdCBTcXVhcmVzIi4KCi0gKkNMTSogaXMgYW4gYWNyb255bSBmb3IgIkNsYXNzaWNhbCBMaW5lYXIgTW9kZWwiLgoKLSAqQkxVRSogaXMgYW4gYWNyb255bSBmb3IgIkJlc3QgTGluZWFyIFVuYmlhc2VkIEVzdGltYXRvciIuCgoKIyMjIEZ1bmN0aW9ucyBsaXN0IHstfQoKCgoKIyMgRXhlcmNpc2VzCgoxLiBGaXJzdCBFeGVyY2lzZQoKCgoKCipUaGUgc29sdXRpb25zIGZvciB0aGUgZXhlcmNpc2VzIHdpbGwgYmUgYXZhaWxhYmxlIGhlcmUgb24gYHIgY29uZmlnJG9sc2AuKgoKCgoKIyMgUmVmZXJlbmNlcwoKSW5nbGVoYXJ0LCBSb25hbGQgRi4gYW5kIE5vcnJpcywgUGlwcGEgKDIwMTYpIFRydW1wLCBCcmV4aXQsIGFuZCB0aGUgUmlzZSBvZiBQb3B1bGlzbTogRWNvbm9taWMgSGF2ZS1Ob3RzIGFuZCBDdWx0dXJhbCBCYWNrbGFzaC4gSEtTIFdvcmtpbmcgUGFwZXIgTm8uIFJXUDE2LTAyNiwgQXZhaWxhYmxlIGF0IFNTUk46IGh0dHBzOi8vc3Nybi5jb20vYWJzdHJhY3Q9MjgxODY1OSBvciBodHRwOi8vZHguZG9pLm9yZy8xMC4yMTM5L3Nzcm4uMjgxODY1OQA=" download="09-ols.Rmd">
<button class="btn btn-default"><i class="fa fa-save"></i> Chapter markdown</button>
</a></p>
<div id="content-8" class="section level2">
<h2><span class="header-section-number">9.1</span> Content</h2>
<center>
<strong>Site still under construction!</strong>
</center>
<div id="introduction-1" class="section level3 unnumbered">
<h3>Introduction</h3>
<p>Data are taken from <a href="https://electionstudies.org/data-center/2020-exploratory-testing-survey/" class="uri">https://electionstudies.org/data-center/2020-exploratory-testing-survey/</a> to model the feelings towards Donald Trump in the lead-up to the presidential election 2020.</p>
</div>
<div id="bivariate-linear-regression" class="section level3 unnumbered">
<h3>Bivariate Linear Regression</h3>
<div id="the-theory" class="section level4 unnumbered">
<h4>The Theory</h4>
</div>
<div id="the-application" class="section level4 unnumbered">
<h4>The Application</h4>
<p>We are using the 2020 Exploratory Testing Survey</p>
<p>Load the ANES data set</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="ols.html#cb670-1"></a>anes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/anes.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="ols.html#cb671-1"></a><span class="kw">summary</span>(anes<span class="op">$</span>fttrump1)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    0.00   40.00   44.59   80.00  999.00 </code></pre>
<p>This is no good, as the variable is bounded between 0 and 100. In fact 999 is a placeholder for missing data throughout the data set. We need to replace this with NAs.</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="ols.html#cb673-1"></a>anes[anes <span class="op">==</span><span class="st"> </span><span class="dv">999</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span></code></pre></div>
<p>If we look at the summary again, everything looks fine now:</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="ols.html#cb674-1"></a><span class="kw">summary</span>(anes<span class="op">$</span>fttrump1)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
   0.00    0.00   40.00   42.42   80.00  100.00       7 </code></pre>
<p>By the way, had you just wanted to replace this in one variable, for example only in <code>fttrump1</code>, you could have called:</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="ols.html#cb676-1"></a>anes<span class="op">$</span>fttrump1 &lt;-<span class="st"> </span><span class="kw">with</span>(anes, <span class="kw">replace</span>(fttrump1, fttrump1 <span class="op">==</span><span class="st"> </span><span class="dv">999</span>, <span class="ot">NA</span>))</span></code></pre></div>
<p>Norris and Inglehart (2016) have argued that:</p>
<blockquote>
<p>populist support in Europe is generally stronger among the older generation, men, the less educated, the religious, and ethnic majorities, patterns confirming previous research.</p>
</blockquote>
<p>Lets see if this also applies to presidential elections in the US. We first look at the question: Do older people rate Trump higher than younger people?. Our independent variables is <code>age</code>.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="ols.html#cb677-1"></a><span class="kw">summary</span>(anes<span class="op">$</span>age)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  18.00   34.75   49.00   48.87   63.00  110.00 </code></pre>
<p>Lets evaluate the relationship through a scatter plot with a line of best fit:</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="ols.html#cb679-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb679-2"><a href="ols.html#cb679-2"></a></span>
<span id="cb679-3"><a href="ols.html#cb679-3"></a><span class="kw">ggplot</span>(anes, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> fttrump1)) <span class="op">+</span></span>
<span id="cb679-4"><a href="ols.html#cb679-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb679-5"><a href="ols.html#cb679-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-403-1.png" width="672" /></p>
<p>There is a positive relationship. We can calculate the exact numerical nature of that relationship as follows:</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="ols.html#cb680-1"></a>model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(fttrump1 <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> anes)</span></code></pre></div>
<p>We start by specifying an object into which we store the results. Then we call <code>lm</code> which means linear model. Our dependent variable <code>fttrump1</code> is listed first, and then after a tilde the independent variable, <code>age</code>. Finally, we tell R which data set to use. We can then print the result, by calling <code>model1</code>.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="ols.html#cb681-1"></a>model1</span></code></pre></div>
<pre><code>
Call:
lm(formula = fttrump1 ~ age, data = anes)

Coefficients:
(Intercept)          age  
    31.6837       0.2197  </code></pre>
<p>How would we interpret these results?</p>
<ul>
<li>At an age of zero, a person would rate Trump at 31.68 <em>on average</em>. This of course makes little sense in anything but a theoretical / mathematical consideration.</li>
<li>With every additional year of age, a person would rate Trump 0.22 points higher <em>on average</em>.</li>
</ul>
<p>But are these findings significant at an acceptable significance level? Lets find out, by getting a more detailed output:</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="ols.html#cb683-1"></a><span class="kw">summary</span>(model1)</span></code></pre></div>
<pre><code>
Call:
lm(formula = fttrump1 ~ age, data = anes)

Residuals:
    Min      1Q  Median      3Q     Max 
-55.847 -39.152  -0.523  39.258  64.143 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 31.68372    2.14801  14.750  &lt; 2e-16 ***
age          0.21967    0.04157   5.284 1.35e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 38.67 on 3071 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.009011,  Adjusted R-squared:  0.008688 
F-statistic: 27.92 on 1 and 3071 DF,  p-value: 1.35e-07</code></pre>
<p>OK, there is a lot more here, and it is worth pausing to go through this step by step. First, R reminds us of the actual formula we have used to estimate the model:</p>
<p><img src="images/9/formula.png" /></p>
<p>I am ignoring the section on residuals for now, as we dont need to make our lives more difficult than it needs to be. I will come back to this under the <a href="ols.html#the-classical-linear-assumptions">The Classical Linear Assumptions</a>. Now come the coefficients:</p>
<p><img src="images/9/coeff.png" /></p>
<p>The size and direction is of course the same as in our previous output, but this output now contains some additional information about the standard error, the resulting t-value, and the p-value. R is very helpful here, in that it offers us a varying amount of asterisks according to different, commonly accepted levels of significance. 0.05 is standard practice in the social sciences, so we will accept anything with one, or more asterisks. Both our intercept and the slope coefficient are significant at a 95% confidence level, so we have shown that there is a statistical relationship between age and ratings for Trump.</p>
<p>I am omitting the residual standard error for the same reason as before, but let us look at the model fit indicators.</p>
<p><img src="images/9/rsquared.png" /></p>
<p>Multiple R-Squared (aka <span class="math inline">\(R^{2}\)</span>) tells us how much variation in the dependent variable <code>fttrump1</code> is explained through the independent variable <code>age</code>. <span class="math inline">\(R^{2}\)</span> runs between 0 and 1, where 1 is equal to 100% of the variation. In our case, we have explained a mere 0.09% of the Trump rating. This is lousy, and we can do a lot better than that. Never expect anything near 100% unless you work with a toy data set from a text book. If you get 60-70% you can be very happy. I will return to Adjusted <span class="math inline">\(R^{2}\)</span> when in the Section on <a href="ols.html#multiple-linear-regression">Multiple Linear Regression</a>.</p>
<p>The F-statistic at the end:</p>
<p><img src="images/9/fstatistic.png" />
is a test with the null hypothesis that all coefficients of the model are jointly zero. In our case, we can reject this null hypothesis very soundly, as the p-value is far below the commonly accepted maximum of 5%.</p>
<div id="categorical-independent-variables-aka-dummies" class="section level5 unnumbered">
<h5>Categorical Independent Variables (aka Dummies)</h5>
<p>Often variables are categorical. One such example is the variable <code>sex</code> which has two categories: male and female.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="ols.html#cb685-1"></a><span class="kw">summary</span>(anes<span class="op">$</span>sex)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   2.000   1.522   2.000   2.000 </code></pre>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="ols.html#cb687-1"></a><span class="kw">table</span>(anes<span class="op">$</span>sex)</span></code></pre></div>
<pre><code>
   1    2 
1473 1607 </code></pre>
<p>Turn this into a factor variable and assign telling labels</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="ols.html#cb689-1"></a>anes<span class="op">$</span>sex &lt;-<span class="st"> </span><span class="kw">factor</span>(anes<span class="op">$</span>sex, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))</span></code></pre></div>
<p>Check if this has worked:</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="ols.html#cb690-1"></a><span class="kw">table</span>(anes<span class="op">$</span>sex)</span></code></pre></div>
<pre><code>
  Male Female 
  1473   1607 </code></pre>
<p>Lets estimate the model:</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="ols.html#cb692-1"></a>model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(fttrump1 <span class="op">~</span><span class="st"> </span>sex, <span class="dt">data =</span> anes)</span>
<span id="cb692-2"><a href="ols.html#cb692-2"></a><span class="kw">summary</span>(model2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = fttrump1 ~ sex, data = anes)

Residuals:
    Min      1Q  Median      3Q     Max 
-46.156 -38.992  -1.156  38.844  61.008 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   46.156      1.009  45.749  &lt; 2e-16 ***
sexFemale     -7.165      1.397  -5.129 3.09e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 38.68 on 3071 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.008493,  Adjusted R-squared:  0.00817 
F-statistic: 26.31 on 1 and 3071 DF,  p-value: 3.095e-07</code></pre>
<p>How do we interpret this?</p>
<ul>
<li>Lets do the slope coefficient first: a women would rate Trump at 7.16 points less than a man on average. The interpretation of a dummy variable coefficient is done with regards to the reference category. In our case this is male. So the effect we observe here is equivalent of moving from male to female and that effect adds 7.16 points.</li>
<li>This gives you an indication of how to interpret the intercept in this case: The value displayed is how men would rate Trump on average, namely at 46.16 points. All of this is significant at a 95% confidence level.</li>
</ul>
<p>This effect corroborates the hypothesis advanced by Inglehart and Norris, but the results are not displayed in the most elegant way. The sex these authors made a statement about were men. So we need to change the reference category to female.</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="ols.html#cb694-1"></a>anes &lt;-<span class="st"> </span>anes <span class="op">%&gt;%</span></span>
<span id="cb694-2"><a href="ols.html#cb694-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">relevel</span>(sex, <span class="dt">ref =</span> <span class="st">&quot;Female&quot;</span>))</span></code></pre></div>
<p>When we re-estimate the model, we get the effect displayed directly:</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="ols.html#cb695-1"></a>model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(fttrump1 <span class="op">~</span><span class="st"> </span>sex, <span class="dt">data =</span> anes)</span>
<span id="cb695-2"><a href="ols.html#cb695-2"></a><span class="kw">summary</span>(model2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = fttrump1 ~ sex, data = anes)

Residuals:
    Min      1Q  Median      3Q     Max 
-46.156 -38.992  -1.156  38.844  61.008 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  38.9919     0.9661  40.358  &lt; 2e-16 ***
sexMale       7.1646     1.3969   5.129 3.09e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 38.68 on 3071 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.008493,  Adjusted R-squared:  0.00817 
F-statistic: 26.31 on 1 and 3071 DF,  p-value: 3.095e-07</code></pre>
<p>Whilst many categorical variables are binary, of course not all of them are. So how does this work with a categorical variable with 3 or more levels?</p>
<p>The next determinant mentioned in Inglehart and Norris paper is education. We can obtain information about a respondents level of education with the variable <code>educ</code>.</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="ols.html#cb697-1"></a><span class="kw">summary</span>(anes<span class="op">$</span>educ)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   3.000   4.000   4.012   5.000   8.000 </code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="ols.html#cb699-1"></a><span class="kw">table</span>(anes<span class="op">$</span>educ)</span></code></pre></div>
<pre><code>
  1   2   3   4   5   6   7   8 
100 656 622 326 761 424 102  89 </code></pre>
<p>This is not terribly telling in itself, yet, so lets have a look at the codebook:</p>
<p><img src="images/9/educ.png" style="width:50.0%" /></p>
<p>The first step is, as before to recode this variable into a factor variable:</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="ols.html#cb701-1"></a>anes<span class="op">$</span>educ &lt;-<span class="st"> </span><span class="kw">factor</span>(anes<span class="op">$</span>educ)</span></code></pre></div>
<p>Eight levels are too many here to do any meaningful analysis, and two would be too reductionist. For sake of simplicity, lets go with three: low, medium and high education. We recode into an ordered factor as follows:</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="ols.html#cb702-1"></a>anes &lt;-<span class="st"> </span>anes <span class="op">%&gt;%</span></span>
<span id="cb702-2"><a href="ols.html#cb702-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">educ_fac =</span> <span class="kw">recode</span>(educ, <span class="st">&#39;1&#39;</span>=<span class="st">&quot;low&quot;</span>, </span>
<span id="cb702-3"><a href="ols.html#cb702-3"></a>                       <span class="st">&#39;2&#39;</span>=<span class="st"> &quot;low&quot;</span>,</span>
<span id="cb702-4"><a href="ols.html#cb702-4"></a>                       <span class="st">&#39;3&#39;</span>=<span class="st"> &quot;low&quot;</span>,</span>
<span id="cb702-5"><a href="ols.html#cb702-5"></a>                       <span class="st">&#39;4&#39;</span> =<span class="st"> &quot;medium&quot;</span>,</span>
<span id="cb702-6"><a href="ols.html#cb702-6"></a>                       <span class="st">&#39;5&#39;</span> =<span class="st"> &quot;medium&quot;</span>,</span>
<span id="cb702-7"><a href="ols.html#cb702-7"></a>                       <span class="st">&#39;6&#39;</span> =<span class="st"> &quot;high&quot;</span>,</span>
<span id="cb702-8"><a href="ols.html#cb702-8"></a>                       <span class="st">&#39;7&#39;</span> =<span class="st"> &quot;high&quot;</span>,</span>
<span id="cb702-9"><a href="ols.html#cb702-9"></a>                       <span class="st">&#39;8&#39;</span> =<span class="st"> &quot;high&quot;</span>))</span></code></pre></div>
<p>Check the results:</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="ols.html#cb703-1"></a><span class="kw">table</span>(anes<span class="op">$</span>educ_fac)</span></code></pre></div>
<pre><code>
   low medium   high 
  1378   1087    615 </code></pre>
<p>And we are ready to go:</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="ols.html#cb705-1"></a>model3 &lt;-<span class="st"> </span><span class="kw">lm</span>(fttrump1 <span class="op">~</span><span class="st"> </span>educ_fac, <span class="dt">data =</span> anes)</span>
<span id="cb705-2"><a href="ols.html#cb705-2"></a><span class="kw">summary</span>(model3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = fttrump1 ~ educ_fac, data = anes)

Residuals:
    Min      1Q  Median      3Q     Max 
-42.943 -42.019  -2.388  37.981  57.981 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     42.0189     1.0481  40.090   &lt;2e-16 ***
educ_facmedium   0.9240     1.5775   0.586    0.558    
educ_fachigh     0.3693     1.8870   0.196    0.845    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 38.85 on 3070 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.0001119, Adjusted R-squared:  -0.0005395 
F-statistic: 0.1718 on 2 and 3070 DF,  p-value: 0.8422</code></pre>
<p>Whilst the intercept is statistically significant, the slope coefficients are not. Therefore, we can conclude that education has no statistical influence on Trumps approval ratings.</p>
<p>Note, that as in the sex example before, R has chose the first level of the independent variable as the reference category. If you wish to change this, you can do so in the same manner as before. You can also check which level R has used as the reference category with the <code>contrasts()</code> command. Here:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="ols.html#cb707-1"></a><span class="kw">contrasts</span>(anes<span class="op">$</span>educ_fac)</span></code></pre></div>
<pre><code>       medium high
low         0    0
medium      1    0
high        0    1</code></pre>
</div>
<div id="summary-for-bivariate-regression" class="section level5 unnumbered">
<h5>Summary for Bivariate Regression</h5>
<p>And thats it! You have made the first big step to understanding regression output and producing such output yourself. But not only has our <code>age</code> variable been rubbish in explaining Trump ratings, but also explanations in the real world are never mono-causal. There are always multiple influences working at the same time, and we need to set up our statistical model to take this complexity into account. Which brings us to the next step: multiple regression.</p>
</div>
</div>
</div>
<div id="multiple-linear-regression" class="section level3 unnumbered">
<h3>Multiple Linear Regression</h3>
<div id="the-theory-1" class="section level4 unnumbered">
<h4>The Theory</h4>
</div>
<div id="the-application-1" class="section level4 unnumbered">
<h4>The Application</h4>
</div>
</div>
<div id="the-classical-linear-assumptions" class="section level3 unnumbered">
<h3>The Classical Linear Assumptions</h3>
<div id="functional-form" class="section level4 unnumbered">
<h4>Functional Form</h4>
</div>
<div id="fixed-x-values" class="section level4 unnumbered">
<h4>Fixed x-values</h4>
<p>Independence of error term from x, Ramseys Reset Test</p>
</div>
<div id="zero-mean-value-of-disturbance" class="section level4 unnumbered">
<h4>Zero Mean Value of Disturbance</h4>
</div>
<div id="homoscedasticity" class="section level4 unnumbered">
<h4>Homoscedasticity</h4>
</div>
<div id="no-autocorrelation-between-errors" class="section level4 unnumbered">
<h4>No Autocorrelation between Errors</h4>
</div>
<div id="no-multicollinearity" class="section level4 unnumbered">
<h4>No Multicollinearity</h4>
</div>
<div id="the-number-of-observations" class="section level4 unnumbered">
<h4>The Number of Observations</h4>
<p> n must be greater than the Number of
Parameters to be estimated</p>
</div>
</div>
</div>
<div id="summary-7" class="section level2">
<h2><span class="header-section-number">9.2</span> Summary</h2>
<ul>
<li><p><em>OLS</em> is an acronym for Ordinary Least Squares.</p></li>
<li><p><em>CLM</em> is an acronym for Classical Linear Model.</p></li>
<li><p><em>BLUE</em> is an acronym for Best Linear Unbiased Estimator.</p></li>
</ul>
<div id="functions-list-7" class="section level3 unnumbered">
<h3>Functions list</h3>
<table>
<colgroup>
<col width="11%" />
<col width="6%" />
<col width="82%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">function</th>
<th align="left">package</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">c()</td>
<td align="left">base</td>
<td align="left">Combine values/vectors into a vector</td>
</tr>
<tr class="even">
<td align="left">factor()</td>
<td align="left">base</td>
<td align="left">create a factor</td>
</tr>
<tr class="odd">
<td align="left">library()</td>
<td align="left">base</td>
<td align="left">load an R package</td>
</tr>
<tr class="even">
<td align="left">summary()</td>
<td align="left">base</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">table()</td>
<td align="left">base</td>
<td align="left">obtain frequency table of a variable/cross-tabulation of two variables</td>
</tr>
<tr class="even">
<td align="left">mutate()</td>
<td align="left">dplyr</td>
<td align="left">modify/create a column in a data frame</td>
</tr>
<tr class="odd">
<td align="left">recode()</td>
<td align="left">dplyr</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">aes()</td>
<td align="left">ggplot2</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">geom_point()</td>
<td align="left">ggplot2</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">geom_smooth()</td>
<td align="left">ggplot2</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">ggplot()</td>
<td align="left">ggplot2</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">contrasts()</td>
<td align="left">stats</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">lm()</td>
<td align="left">stats</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">relevel()</td>
<td align="left">stats</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">read.csv()</td>
<td align="left">utils</td>
<td align="left">read a csv file to data frame. Specify stringsAsFactors = FALSE to keep all string columns as characters</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exercises-7" class="section level2">
<h2><span class="header-section-number">9.3</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>First Exercise</li>
</ol>
<p><em>The solutions for the exercises will be available here on 2021-02-18.</em></p>
</div>
<div id="references" class="section level2">
<h2><span class="header-section-number">9.4</span> References</h2>
<p>Inglehart, Ronald F. and Norris, Pippa (2016) Trump, Brexit, and the Rise of Populism: Economic Have-Nots and Cultural Backlash. HKS Working Paper No.RWP16-026, Available at SSRN: <a href="https://ssrn.com/abstract=2818659" class="uri">https://ssrn.com/abstract=2818659</a> or <a href="http://dx.doi.org/10.2139/ssrn.2818659" class="uri">http://dx.doi.org/10.2139/ssrn.2818659</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="association.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toc_depth": 2
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
